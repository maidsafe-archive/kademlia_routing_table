<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `kademlia_routing_table` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, kademlia_routing_table">

    <title>kademlia_routing_table - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">

    <link rel="shortcut icon" href="http://maidsafe.net/img/favicon.ico">
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        <a href='../kademlia_routing_table/index.html'><img src='https://raw.githubusercontent.com/maidsafe/QA/master/Images/maidsafe_logo.png' alt='' width='100'></a>
        <p class='location'></p><script>window.sidebarCurrent = {name: 'kademlia_routing_table', ty: 'mod', relpath: '../'};</script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>kademlia_routing_table</a></span><span class='out-of-band'><span id='render-detail'>
            <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                [<span class='inner'>&#x2212;</span>]
            </a>
        </span><a id='src-0' class='srclink' href='../src/kademlia_routing_table/lib.rs.html#18-1253' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>A routing table to manage connections for a node in a <a href="https://en.wikipedia.org/wiki/Kademlia">Kademlia</a> distributed hash table.</p>

<h1 id='addresses-and-distance-functions' class='section-header'><a href='#addresses-and-distance-functions'>Addresses and distance functions</a></h1>
<p>Nodes in the network are addressed with a <a href="../xor_name/struct.XorName.html"><code>XorName</code></a>, a 512-bit unsigned integer. The
<em><a href="https://en.wikipedia.org/wiki/Exclusive_or#Bitwise_operation">XOR</a> distance</em> between two nodes with addresses <code>x</code> and <code>y</code> is <code>x ^ y</code>. This
<a href="https://en.wikipedia.org/wiki/Metric_%28mathematics%29">distance function</a> has the property that no two points ever have the same distance from a
given point, i. e. if <code>x ^ y == x ^ z</code>, then <code>y == z</code>. This property allows us to define the
<em>close group</em> of an address as the <a href="constant.GROUP_SIZE.html"><code>GROUP_SIZE</code></a> closest nodes to that address,
guaranteeing that the close group will always have exactly <code>GROUP_SIZE</code> members (unless, of
course, the whole network has less than <code>GROUP_SIZE</code> nodes).</p>

<p>The routing table is associated with a node with some name <code>x</code>, and manages a number of
connections to other nodes, sorting them into up to 512 <em>buckets</em>, depending on their XOR
distance from <code>x</code>:</p>

<ul>
<li>If 2<sup>512</sup> &gt; <code>x ^ y</code> &gt;= 2<sup>511</sup>, then y is in bucket 0.</li>
<li>If 2<sup>511</sup> &gt; <code>x ^ y</code> &gt;= 2<sup>510</sup>, then y is in bucket 1.</li>
<li>If 2<sup>510</sup> &gt; <code>x ^ y</code> &gt;= 2<sup>509</sup>, then y is in bucket 2.</li>
<li>...</li>
<li>If 2 &gt; <code>x ^ y</code> &gt;= 1, then y is in bucket 511.</li>
</ul>

<p>Equivalently, <code>y</code> is in bucket <code>n</code> if the longest common prefix of <code>x</code> and <code>y</code> has length <code>n</code>,
i. e. the first binary digit in which <code>x</code> and <code>y</code> disagree is the <code>(n + 1)</code>-th one. We call the
length of the remainder, without the common prefix, the <em>bucket distance</em> of <code>x</code> and <code>y</code>. Hence
<code>x</code> and <code>y</code> have bucket distance <code>512 - n</code> if and only if <code>y</code> belongs in bucket number <code>n</code>.</p>

<p>The bucket distance is coarser than the XOR distance: Whenever the bucket distance from <code>y</code> to
<code>x</code> is less than the bucket distance from <code>z</code> to <code>x</code>, then <code>y ^ x &lt; z ^ x</code>. But not vice-versa:
Often <code>y ^ x &lt; z ^ x</code>, even if the bucket distances are equal. The XOR distance ranges from 0
to 2<sup>512</sup> (exclusive), while the bucket distance ranges from 0 to 512 (inclusive).</p>

<h1 id='guarantees-for-routing' class='section-header'><a href='#guarantees-for-routing'>Guarantees for routing</a></h1>
<p>The routing table provides functions to decide, for a message with a given destination, which
nodes in the table to pass the message on to, so that it is guaranteed that:</p>

<ul>
<li>If the destination is the address of a node, the message will reach that node after at most
511 hops.</li>
<li>Otherwise the message will reach every member of the close group of the destination address,
i. e. all <code>GROUP_SIZE</code> nodes in the network that are XOR-closest to that address, and each
node knows whether it belongs to that group.</li>
</ul>

<p>However, to be able to make these guarantees, the routing table must be filled with
sufficiently many connections. Specifically, for the first property to be true, the first of
the following invariants is needed, and for the second property, the second, stronger one, must
be ensured:</p>

<ul>
<li>Each bucket <code>n</code> must have an entry if a node with bucket distance <code>512 - n</code> exists in the
network.</li>
<li>Whenever a bucket <code>n</code> has fewer than <code>GROUP_SIZE</code> entries, it contains <em>all</em> nodes in the
network with bucket distance <code>512 - n</code>.</li>
</ul>

<p>The user of this crate therefore needs to make sure that whenever a node joins or leaves, all
affected nodes in the network update their routing tables accordingly.</p>

<h1 id='resilience-against-malicious-or-malfunctioning-nodes' class='section-header'><a href='#resilience-against-malicious-or-malfunctioning-nodes'>Resilience against malicious or malfunctioning nodes</a></h1>
<p>In each hop during routing, messages are passed on to <code>PARALLELISM</code> other nodes, so that even
if <code>PARALLELISM - 1</code> nodes between the source and destination fail, they are still successfully
delivered.</p>

<p>The concept of close groups exists to provide resilience even against failures of the source or
destination itself: If every member of a group tries to send the same message, it will arrive
even if some members fail. And if a message is sent to a whole group, it will arrive in most,
even if some of them malfunction.</p>

<p>Close groups can thus be used as inherently redundant authorities in the network that messages
can be sent to and received from, using a consensus algorithm: A message from a group authority
is considered to be legitimate, if at least <code>QUORUM_SIZE</code> group members have sent (and
cryptographically signed) a message with the same content.</p>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.NodeInfo.html'
                               title='kademlia_routing_table::NodeInfo'>NodeInfo</a></td>
                        <td class='docblock short'>
                             <p>A routing table entry representing a node and the connections to that node.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.RoutingTable.html'
                               title='kademlia_routing_table::RoutingTable'>RoutingTable</a></td>
                        <td class='docblock short'>
                             <p>A routing table to manage connections for a node.</p>

                        </td>
                    </tr>
                </table><h2 id='constants' class='section-header'><a href="#constants">Constants</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='constant' href='constant.GROUP_SIZE.html'
                               title='kademlia_routing_table::GROUP_SIZE'>GROUP_SIZE</a></td>
                        <td class='docblock short'>
                             <p>The size of a close group.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='constant' href='constant.PARALLELISM.html'
                               title='kademlia_routing_table::PARALLELISM'>PARALLELISM</a></td>
                        <td class='docblock short'>
                             <p>The number of nodes a message is sent to in each hop for redundancy.</p>

                        </td>
                    </tr>
                </table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.HasName.html'
                               title='kademlia_routing_table::HasName'>HasName</a></td>
                        <td class='docblock short'>
                             <p>A trait for anything that has a <code>XorName</code> and can thus be addressed in the network.</p>

                        </td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "kademlia_routing_table";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>